{% extends 'base.html' %}

{% block page_title %}{{ match_id }} Match Stats | HonBot {% endblock %}
{% block headers %}
{% endblock %}
{% block main_content %}
<header class="player-head">
    <div class="container">
        <div class="row">
            <div class="col-lg-7 col-md-6 col-sm-6 col-xs-12">
                <h2><img class="pull-left" src="/static/img/maps/{{ match.map }}.jpg">Match: {{ match_id }}</h2>
            </div>
            <div class="col-lg-5 col-md-6 col-sm-12 col-xs-12">
                <div class="col-lg-3 col-md-3 col-sm-3 col-xs-3 text-center">
                    <h4 style="margin-bottom: 2px;">Winner</h4>{% if match.players.0.win %}Legion{% else %}Hellbourne{% endif %}
                </div>
                <div class="col-lg-3 col-md-3 col-sm-3 col-xs-3 text-center">
                    <h4 style="margin-bottom: 2px;">Type</h4>{{ match.mode }}
                </div>
                <div class="col-lg-3 col-md-3 col-sm-3 col-xs-3 text-center">
                    <h4 style="margin-bottom: 2px;">Duration</h4>{{ match.realtime }}
                </div>
                <div class="col-lg-3 col-md-3 col-sm-3 col-xs-3 text-center">
                    {% load prettytimes_tags %}
                    <h4 style="margin-bottom: 2px;">Played</h4>{{ match.date|relative_time }}
                </div>
            </div>
        </div>
    </div>
</header>
<div class="container">
    <div class="row">
        <div class="col-lg-12">
            <ul class="nav nav-pills nav-justified">
                <li class="active"><a href="/match/{{ match_id }}/">Overview</a></li>
                <li><a href="/chat/{{ match_id }}/">Chat Logs</a></li>
                <li><a href="/builds/{{ match_id }}/">Builds</a></li>
            </ul>
        </div>
    </div>
</div>
<div class="container">
    <div class="row">
        <div class="col-lg-12">
            <table class="table table-condensed table-match table-responsive">
                <thead>
                    <tr>
                        <th>Player</th>
                        <th>Items</th>
                        <th title="Level">lvl</th>
                        <th title="Kills">K</th>
                        <th title="Deaths">D</th>
                        <th title="Assists">A</th>
                        <th title="Kill Death Ratio">KDR</th>
                        <th title="Creep Kills">CK</th>
                        <th title="Creep Denies">CD</th>
                        <th title="Gold Per Minute">GPM</th>
                        <th title="XP per minute">XP</th>
                        <th title="Actions Per Minute">APM</th>
                        <th title="Wards">W</th>
                    </tr>
                </thead>
                <tbody>
                {% for player in players %}
                {% if player.position == 5 %}</tbody><tbody>{% endif %}
                    <tr class="player-{{ player.position }}-row">
                        <td>
                            <img style="width:30px" src='/static/img/heroes/{{ player.hero }}/icon_128.jpg'> 
                            <a href="/player/{{ player.nickname }}/">
                                {{ player.nickname }} 
                            </a>
                        </td>
                        <td>
                            {% for item in player.items %}
                                {% if item != None  %}
                                    <img style="width:30px;" src='/static/img/items/{{ item }}.jpg'>
                                {% endif %}
                            {% endfor %}
                        </td>
                        <td>{{ player.level }}</td>
                        <td>{{ player.kills }}</td>
                        <td>{{ player.deaths }}</td>
                        <td>{{ player.assists }}</td>
                        <td>{{ player.kdr }}</td>
                        <td>{{ player.cs }}</td>
                        <td>{{ player.denies }}</td>
                        <td>{{ player.gpm }}</td>
                        <td>{{ player.xpm }}</td>
                        <td>{{ player.apm }}</td>
                        <td>{{ player.wards }}</td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
<div class="container">
    <div class="row">
        <div class="col-lg-12">
            <h2 class="text-center">Hero Damage</h2>
            <div class="row">
                <div class="col-lg-6 col-md-6 stats-title">
                    <div id="ldmg" style="min-width: 300px; height: 300px; margin: 0 auto"></div>
                </div>
                <div class="col-lg-6 col-md-6 stats-title">
                    <div id="hdmg" style="min-width: 300px; height: 300px; margin: 0 auto"></div>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-lg-6">
            <h2 class="text-center">Gold Per Minute</h2>
            <div id="lgpm" style="min-width: 300px; height: 350px; margin: 0 auto"></div>
        </div>
        <div class="col-lg-6">
            <h2 class="text-center">Team Totals</h2>
            <div class="row">
                <div class="col-lg-4">
                    <div id="kills" style="min-width: 50px; height: 200px; margin: 0 auto"></div>
                </div>
                <div class="col-lg-4">
                    <div id="assists" style="min-width: 50px; height: 200px; margin: 0 auto"></div>
                </div>
                <div class="col-lg-4">
                    <div id="xpm" style="min-width: 50px; height: 200px; margin: 0 auto"></div>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-4">
                    <div id="creeps" style="min-width: 50px; height: 200px; margin: 0 auto"></div>
                </div>
                <div class="col-lg-4">
                    <div id="gpm" style="min-width: 50px; height: 200px; margin: 0 auto"></div>
                </div>
                <div class="col-lg-4">
                    <div id="apm" style="min-width: 50px; height: 200px; margin: 0 auto"></div>
                </div>
            </div>
        </div>
    </div>
</div>
{%block js%}
<script src="/static/js/highcharts.js"></script>
<script>
//legion herodmg
$(function () {
    var chart;
    $(document).ready(function() {
        chart = new Highcharts.Chart({
            chart: {
                renderTo: 'ldmg',
                backgroundColor: null,
                plotBackgroundColor: null,
                plotBorderWidth: null,
                plotShadow: false,
            },
            plotOptions: {
                pie: {
                    allowPointSelect: true,
                    cursor: 'pointer',
                    animation: false,
                    dataLabels: {
                        enabled: true,
                        style: {color: '#000;'},
                        formatter: function() {
                            return '<b>'+ this.point.name +'</b>: '+ Math.round(this.percentage) + '%';
                        }
                    }
                }
            },
            title: {
               text: ''
            },
            colors: ['#002c9f', '#00c19e', '#770092', '#f2d500', '#ff7d29'],
            credits: {
                enabled: false
            },
            exporting: { enabled: false },
            series: [{
                type: 'pie',
                name: 'Damage',
                data: [
                    ['{{ players.0.nickname }}', {{ players.0.herodmg }}],
                    ['{{ players.1.nickname }}', {{ players.1.herodmg }}],
                    ['{{ players.2.nickname }}', {{ players.2.herodmg }}],
                    ['{{ players.3.nickname }}', {{ players.3.herodmg }}],
                    ['{{ players.4.nickname }}', {{ players.4.herodmg }}]
                ]
            }]
        });
    });
    
});
</script>
<script>
//hellbourne herodmg
$(function () {
    var chart;
    $(document).ready(function() {
        chart = new Highcharts.Chart({
            chart: {
                renderTo: 'hdmg',
                backgroundColor: null,
                plotBackgroundColor: null,
                plotBorderWidth: null,
                plotShadow: false
            },
            plotOptions: {
                pie: {
                    allowPointSelect: true,
                    cursor: 'pointer',
                    animation: false,
                    dataLabels: {
                        enabled: true,
                        style: {color: '#000;'},
                        formatter: function() {
                            return '<b>'+ this.point.name +'</b>: '+ Math.round(this.percentage) + '%';
                        }
                    }
                }
            },
            title: {
               text: ''
            },
            credits: {
                enabled: false
            },
            colors: ['#ff44ab', '#727272', '#00a0da', '#006448', '#562507'],
            exporting: { enabled: false },
            series: [{
                type: 'pie',
                name: 'Damage',
                data: [
                    ['{{ players.5.nickname }}', {{ players.5.herodmg }}],
                    ['{{ players.6.nickname }}', {{ players.6.herodmg }}],
                    ['{{ players.7.nickname }}', {{ players.7.herodmg }}],
                    ['{{ players.8.nickname }}', {{ players.8.herodmg }}],
                    ['{{ players.9.nickname }}', {{ players.9.herodmg }}]
                ]
            }]
        });
    });
    
});
</script>
<script>
$(function () {
        $('#lgpm').highcharts({
            chart: {
                type: 'column',
                backgroundColor: null
            },
            title: {
                text: ''
            },
            xAxis: {
                categories: [
                    ''
                ]
            },
            yAxis: {
                min: 0,
                title: {
                    enabled: false
                }
            },
            tooltip: {
                followPointer: true,
                hideDelay: 50,
                formatter: function() {
                    return this.y;
                }
            },
            plotOptions: {
                column: {
                    pointPadding: 0.1,
                    borderWidth: 0,
                    groupPadding: 0,
                    animation: false
                }
            },
            colors: ['#002c9f', '#00c19e', '#770092', '#f2d500', '#ff7d29', '#ff44ab', '#727272', '#00a0da', '#006448', '#562507'],
            credits: {
                enabled: false
            },
            series: [{
                name: '{{ players.0.nickname }}',
                data: [{{ players.0.gpm }}]
    
            }, {
                name: '{{ players.1.nickname }}',
                data: [{{ players.1.gpm }}]
    
            }, {
                name: '{{ players.2.nickname }}',
                data: [{{ players.2.gpm }}]
    
            }, {
                name: '{{ players.3.nickname }}',
                data: [{{ players.3.gpm }}]
    
            }, {
                name: '{{ players.4.nickname }}',
                data: [{{ players.4.gpm }}]
    
            }, {
                name: '{{ players.5.nickname }}',
                data: [{{ players.5.gpm }}]
    
            }, {
                name: '{{ players.6.nickname }}',
                data: [{{ players.6.gpm }}]
    
            }, {
                name: '{{ players.7.nickname }}',
                data: [{{ players.7.gpm }}]
    
            }, {
                name: '{{ players.8.nickname }}',
                data: [{{ players.8.gpm }}]
    
            }, {
                name: '{{ players.9.nickname }}',
                data: [{{ players.9.gpm }}]
    
            }]
        });
    });
</script>
<script>
//total kills
$(function () {
    var chart;
    $(document).ready(function() {
        chart = new Highcharts.Chart({
            chart: {
                renderTo: 'kills',
                backgroundColor: null,
                plotBackgroundColor: null,
                plotBorderWidth: null,
                plotShadow: false,
            },
            plotOptions: {
                pie: {
                    allowPointSelect: true,
                    cursor: 'pointer',
                    animation: false,
                    dataLabels: {
                        enabled: false
                    }
                }
            },
            title: {
               text: 'Kills',
               style: {
                 color: '#000',
                 font: 'bold 16px "Helvetica Neue", Helvetica, sans-serif'
              }
            },
            colors: ['#c0392b', '#27ae60'],
            credits: {
                enabled: false
            },
            exporting: { enabled: false },
            series: [{
                type: 'pie',
                name: 'Kills',
                data: [
                    ['Hellbourne', ({% for p in players %}{% if p.team == 2%}+{{p.kills}}{%endif%}{% endfor %})],
                    ['Legion', ({% for p in players %}{% if p.team == 1%}+{{p.kills}}{%endif%}{% endfor %})]
                ]
            }]
        });
    });
    
});
</script>
<script>
//total xpm
$(function () {
    var chart;
    $(document).ready(function() {
        chart = new Highcharts.Chart({
            chart: {
                renderTo: 'xpm',
                backgroundColor: null,
                plotBackgroundColor: null,
                plotBorderWidth: null,
                plotShadow: false,
            },
            plotOptions: {
                pie: {
                    allowPointSelect: true,
                    cursor: 'pointer',
                    animation: false,
                    dataLabels: {
                        enabled: false
                    }
                }
            },
            title: {
               text: 'XPM',
               style: {
                 color: '#000',
                 font: 'bold 16px "Helvetica Neue", Helvetica, sans-serif'
              }
            },
            tooltip: {
                pointFormat: '{series.name}: <b>{point.y:.1f}</b>',
                percentageDecimals: 1
            },
            colors: ['#c0392b', '#27ae60'],
            credits: {
                enabled: false
            },
            exporting: { enabled: false },
            series: [{
                type: 'pie',
                name: 'Deaths',
                data: [
                    ['Hellbourne', ({% for p in players %}{% if p.team == 2%}+{{p.xpm}}{%endif%}{% endfor %})],
                    ['Legion', ({% for p in players %}{% if p.team == 1%}+{{p.xpm}}{%endif%}{% endfor %})]
                ]
            }]
        });
    });
    
});
</script>
<script>
//total assists
$(function () {
    var chart;
    $(document).ready(function() {
        chart = new Highcharts.Chart({
            chart: {
                renderTo: 'assists',
                backgroundColor: null,
                plotBackgroundColor: null,
                plotBorderWidth: null,
                plotShadow: false,
            },
            plotOptions: {
                pie: {
                    allowPointSelect: true,
                    cursor: 'pointer',
                    animation: false,
                    dataLabels: {
                        enabled: false
                    }
                }
            },
            title: {
               text: 'Assists',
               style: {
                 color: '#000',
                 font: 'bold 16px "Helvetica Neue", Helvetica, sans-serif'
              }
            },
            colors: ['#c0392b', '#27ae60'],
            credits: {
                enabled: false
            },
            exporting: { enabled: false },
            series: [{
                type: 'pie',
                name: 'Assists',
                data: [
                    ['Hellbourne', ({% for p in players %}{% if p.team == 2%}+{{p.assists}}{%endif%}{% endfor %})],
                    ['Legion', ({% for p in players %}{% if p.team == 1%}+{{p.assists}}{%endif%}{% endfor %})]
                ]
            }]
        });
    });
    
});
</script>
<script>
//total creeps
$(function () {
    var chart;
    $(document).ready(function() {
        chart = new Highcharts.Chart({
            chart: {
                renderTo: 'creeps',
                backgroundColor: null,
                plotBackgroundColor: null,
                plotBorderWidth: null,
                plotShadow: false,
            },
            plotOptions: {
                pie: {
                    allowPointSelect: true,
                    cursor: 'pointer',
                    animation: false,
                    dataLabels: {
                        enabled: false
                    }
                }
            },
            title: {
               text: 'Creeps',
               style: {
                 color: '#000',
                 font: 'bold 16px "Helvetica Neue", Helvetica, sans-serif'
              }
            },
            colors: ['#c0392b', '#27ae60'],
            credits: {
                enabled: false
            },
            exporting: { enabled: false },
            series: [{
                type: 'pie',
                name: 'Creeps',
                data: [
                    ['Hellbourne', ({% for p in players %}{% if p.team == 2%}+{{p.cs}}{%endif%}{% endfor %})],
                    ['Legion', ({% for p in players %}{% if p.team == 1%}+{{p.cs}}{%endif%}{% endfor %})]
                ]
            }]
        });
    });
    
});
</script>
<script>
//total gpm
$(function () {
    var chart;
    $(document).ready(function() {
        chart = new Highcharts.Chart({
            chart: {
                renderTo: 'gpm',
                backgroundColor: null,
                plotBackgroundColor: null,
                plotBorderWidth: null,
                plotShadow: false,
            },
            plotOptions: {
                pie: {
                    allowPointSelect: true,
                    cursor: 'pointer',
                    animation: false,
                    dataLabels: {
                        enabled: false
                    }
                }
            },
            title: {
               text: 'GPM',
               style: {
                 color: '#000',
                 font: 'bold 16px "Helvetica Neue", Helvetica, sans-serif'
              }
            },
            tooltip: {
                pointFormat: '{series.name}: <b>{point.y:.1f}</b>',
                percentageDecimals: 1
            },
            colors: ['#c0392b', '#27ae60'],
            credits: {
                enabled: false
            },
            exporting: { enabled: false },
            series: [{
                type: 'pie',
                name: 'GPM',
                data: [
                    ['Hellbourne', ({% for p in players %}{% if p.team == 2%}+{{p.gpm}}{%endif%}{% endfor %})],
                    ['Legion', ({% for p in players %}{% if p.team == 1%}+{{p.gpm}}{%endif%}{% endfor %})]
                ]
            }]
        });
    });
    
});
</script>
<script>
//total apm
$(function () {
    var chart;
    $(document).ready(function() {
        chart = new Highcharts.Chart({
            chart: {
                renderTo: 'apm',
                backgroundColor: null,
                plotBackgroundColor: null,
                plotBorderWidth: null,
                plotShadow: false,
            },
            plotOptions: {
                pie: {
                    allowPointSelect: true,
                    cursor: 'pointer',
                    animation: false,
                    dataLabels: {
                        enabled: false
                    }
                }
            },
            title: {
               text: 'APM',
               style: {
                 color: '#000',
                 font: 'bold 16px "Helvetica Neue", Helvetica, sans-serif'
              }
            },
            tooltip: {
                pointFormat: '{series.name}: <b>{point.y:.1f}</b>',
                percentageDecimals: 1
            },
            colors: ['#c0392b', '#27ae60'],
            credits: {
                enabled: false
            },
            exporting: { enabled: false },
            series: [{
                type: 'pie',
                name: 'APM',
                data: [
                    ['Hellbourne', ({% for p in players %}{% if p.team == 2%}+{{p.apm}}{%endif%}{% endfor %})],
                    ['Legion', ({% for p in players %}{% if p.team == 1%}+{{p.apm}}{%endif%}{% endfor %})]
                ]
            }]
        });
    });
    
});
</script>
{%endblock js%}
{% endblock main_content %}